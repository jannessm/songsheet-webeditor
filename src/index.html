<!DOCTYPE html>
<html>

<head>
    <!-- for FF, Chrome, Opera -->
    <link rel="icon" type="image/png" href="./asset/logo-16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="./asset/logo-32.png" sizes="32x32">

    <!-- for IE -->
    <link rel="icon" type="image/x-icon" href="./asset/logo.ico">
    <link rel="shortcut icon" type="image/x-icon" href="./asset/logo.ico" />

    <title>B.and Songsheet Editor</title>

    <!-- Load Styles -->
    <link rel="stylesheet" type="text/css" href="./styles/style.css">
    <link rel="stylesheet" type="text/css" href="./styles/buttons.css">
    <link rel="stylesheet" type="text/css" href="./styles/wysiwyg.css">
    <link rel="stylesheet" type="text/css" href="./styles/scrollbar.css">
    <link rel="stylesheet" type="text/css" href="./styles/standart-elements.css">
    <link rel="stylesheet" type="text/css" href="./styles/fonts.css">


    <!-- Load scripts -->
    <script src="./script/songsheet.min.js" type="text/javascript"></script>
    <script src="./script/wysiwyg.js" type="text/javascript"></script>
    <script src="./script/editor.js" type="text/javascript"></script>
    <script src="./script/utils.js" type="text/javascript"></script>

</head>

<body>
    <div id="title_logo">
        <span style="position: absolute; padding-top: 10px;">Songsheet</span>
        <img src="asset/logo.svg">
        <span style="float:right; padding-top: 10px">Editor</span>
    </div>

    <div class="standard--tab">
        <label>
            <input checked onchange="preview()" id="drawLines" type="checkbox" class="control-element">
             Draw Table
        </label>

        <label>
            Select Font: 
            <select onchange="preview()" class="control-element" id="font_select">
            </select>
        </label>
        
        <label style="float: right; margin-right: 50px" class="control-element">
                <a onclick="generate()" class="button-base footer-button">Download PDF</a>
        </label>
        <label style="float: right; margin-right: 20px" class="control-element">
            <a onclick="download_file" class="button-base footer-button">Download .st</a>
        </label>
        <label style="float: right; margin-right: 50px" class="control-element">
            <a onclick="toggle_help()" class="button-base footer-button">How to</a>
        </label>
    </div>
    <!-- Editor Section -->
    <section class="section--editor">
        <textarea oninput="preview()" id="editor" class="font_style editor">[TITLE:How great is our god; bpm: 100]

[ORDER:Intro,Str 1,Ref,Str 2,Ref, Bridge, Ref, Ref]

[block: Intro]
[G] [Em7] [C] [D] [G]

[BLOCK: Str 1]
The *[G]sple<r>ndor* of <b>the Kin<r>g, [Em7]clo**thed in<r> ma**jesty
Let all the earth re[C]joice, All the earth re[D]joice | so sehen | annotationen aus
He [G]wraps himself in Light, and [Em7]darkness tries to hide
And trembles at His [C]voice, Trembles at His [D]voice

[BLOCK: Ref]
How [G]great is our God, sing with me       | test1     ;   test2; test3; test4; test5 | always
How [Em7]great is our God, and all will see
How [Cmaj7]great, how [D]great is our [G]God

[BLOCK: Str 2]
[G]Age to age He stands, and [Em7]time is in His hands
Beginning and the [C]end, Beginning and the [D]end
The [G]Godhead Three in One, [Em7]Father Spirit Son
The [C]Lion and the Lamb, The [D]Lion and the Lamb

[bLoCk: Bridge]
[G]Name above all names, [Em7]Worthy of our praise
My [Cmaj7]heart will sing, How [D]great is our [G]God



</textarea>
    </section>

    <!-- Preview Section -->
    <section class="section--preview">
        <div id="previewRenderer" style="margin-top:10px"></div>
        <div id="help" style="opacity: 0;"><h3>Wie wird der Editor benutzt?</h3>
            Auf der linken Seite befindet sich ein Editor, in dem das gew&uuml;nschte Lied bearbeitet und geschrieben werden kann.
            Auf der rechten Seite wird das PDF als Vorschau gezeigt.<br>

            <h3>Elemente</h3>
            <h4>Informationen</h4>
            Alle aufgelisteten Objekte k&ouml;nnen auch durch Simikolons getrennt in einem Klammerpaar zusammengefasst werden. Beispiel:<br>
            <b><code>[title: How Great is our God; bpm: 100]</code></b>
            <table>
                <tr>
                    <td><code><b>[title: How Great is our God]</b></code></td>
                    <td>Titel</td>
                </tr>
                <tr>
                    <td><code><b>[artist: Chance]</b></code></td>
                    <td>K&uuml;stler</td>
                </tr>
                <tr>
                    <td><code><b>[bpm: 100]</b></code></td>
                    <td>Titel</td>
                </tr>
                <tr>
                    <td><code><b>[books: FJ4 - 129, FJ3 - 28]</b></code></td>
                    <td>Referenzen durch Kommata separiert</td>
                </tr>
            </table>
            <h4>Abschnitte</h4>
            <h5>Bl&ouml;cke</h5>
            Strophen und Refrain werden in Bl&ouml;cken angegeben, der mit der Zeile<br>
            <code><b>[Block: Strophe 1]</b></code><br>
            startet.
            Anschlie&szlig;end kommt der Inhalt der Strophe. Akkorde werden in eckigen Klammern angegeben an der Stelle, an der sie
            gespielt werden sollen. Beispiel:<br>
            <code>How [G]great is our God, sing with me</code><br>

            <h5>Reihenfolge</h5>
            Damit nicht jeder Block mehrmals geschrieben werden muss, kann die Reihenfolge am Anfang angegeben werden. Somit muss im
            Dokument nur einmal der Refrain geschrieben werden, erscheint aber an jeder ben&ouml;tigten Stelle in der PDF.<br>
            <code>[order: Strophe 1, Refrain, Strophe 2, Refrain, Refrain]</code><br>
            Wichtig ist, dass die Titel der Bl&ouml;cke genau so geschrieben werden, wie zu beginn des Blockes.<br>

            <h5>Notizen</h5>
            M&ouml;chte man sich Notizen machen, k&ouml;nnen diese hinter die entsprechende Zeile geschrieben werden. Abgetrennt werden diese
            mit dem Zeichen <code>|</code>. Beispiel:<br>
            <code>How [G]great is our God, sing with me | lauter werden | Solo Laura</code><br>
            Hier werden zwei Tabellenspalten kreiert. In der ersten steht <code>lauter werden</code> und in der zweiten <code>Solo Laura</code>.<br>
            Wird die Strophe mehrmals wiederholt und bei jedem vorkommen der Strophe soll etwas anderes stehen, kann das durch Semikolons geschehen:<br>
            <code>How [G]great is our God, sing with me | lauter werden | Solo Laura; Solo Mia</code><br>
            In der ersten Wiederholung wird nur <code>Solo Laura</code> erscheinen und in der zweiten dann <code>Solo Mia</code>.<br>

            <h4>Formatierungen</h4>
            Folgende Formatierungen stehen zur verf&uuml;gung:<br>
            <table>
                <tr>
                    <td><code><i>*text*</i></code></td>
                    <td>schr&auml;ger Text</td>
                </tr>
                <tr>
                    <td><code><b>**text**</b></code></td>
                    <td>dicker Text</td>
                </tr>
                <tr>
                    <td><code style="color: red">&lt;r>Text&lt;r></code></td>
                    <td>roter Text</td>
                </tr>
                <tr>
                    <td><code style="color: green">&lt;g>Text&lt;g></code></td>
                    <td>gr&uuml;ner Text</td>
                </tr>
                <tr>
                    <td><code style="color: blue">&lt;b>Text&lt;b></code></td>
                    <td>roter Text</td>
                </tr>
            </table></div>
    </section>

    <script type="text/javascript">
        let songJson;

        function generate(toPdf) {
            let drawTable = document.getElementById("drawLines").checked;
            let songsheetGen = new SongsheetGen();
            let sheet = document.getElementById("editor").value;

            // set font
            let font_select = document.getElementById('font_select');
            let font = undefined;
            if(font_select.options[font_select.selectedIndex])
                font = font_select.options[font_select.selectedIndex].value;

            songsheetGen.add_song(sheet, { table: drawTable, annotations: true , font: font});
            songJson = songsheetGen.gen(toPdf);
        }

        function preview() {
            let drawTable = document.getElementById("drawLines").checked;
            generate(false);
            let wysiwyg = new Wysiwyg(drawTable);
            let preview = wysiwyg.convert(songJson);
            document.getElementById("previewRenderer").innerHTML = preview;
        }

        //setup events of editor
        let editor = new Editor(document.getElementById('editor'));
        /*
        * editor.get_text() can also be used to get the text of the textarea.
        * */

        // update font selector
        for(let font in new SongsheetGen().get_available_fonts()){
            let new_option = document.createElement('option');
            new_option.text = font;
            new_option.value = font;
            document.getElementById('font_select').add(new_option);
            if(font === 'ubuntu')
                new_option.selected = true;
            preview();
        }
    </script>
</body>

</html>